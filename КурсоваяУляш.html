<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Уляшкина Алена, 125группа, ПАЭ" />

<meta name="date" content="2018-03-28" />

<title>Курсовая работа</title>






<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Курсовая работа</h1>
<h4 class="author"><em>Уляшкина Алена, 125группа, ПАЭ</em></h4>
<h4 class="date"><em>2018-03-28</em></h4>



<div id="----------2013-------" class="section level1">
<h1>Создание моделей линейной регрессии потоков углексилого газа за осенний период 2013 года по данным измерений методом турбулентной пульсации</h1>
<div id="--" class="section level2">
<h2>Обработка первоначальных данных</h2>
<div id="---" class="section level3">
<h3>Подготовка к корреляционному анализу</h3>
<p>tbl = read.csv(“eddypro.csv”, skip = 1, na = c(“”,“NA”,“-9999”, “-9999.0”),</p>
<p>comment = c(“[”))</p>
</div>
<div id="-" class="section level3">
<h3>Преобразуем таблицу</h3>
<p>tbl = tbl[-1,]</p>
<p>tbl</p>
</div>
<div id="----------" class="section level3">
<h3>Из всего количества данных выбираем те, которые связанны с осенним периодом</h3>
<p>tbl=tbl[tbl<span class="math inline">\(DOY &gt; 244 &amp; tbl\)</span>DOY &lt; 335,]</p>
<p>tbl</p>
</div>
<div id="----------glimpse-------" class="section level3">
<h3>Внимательнее посмотрим на сами переменные и для этого воспользуеся функцией glimpse(), которая более наглядно представляет каждую отдельную переменную</h3>
<p>glimpse(tbl)</p>
</div>
<div id="select-----------" class="section level3">
<h3>Select() позволяет быстро получить полезное подмножество, используя операции, основанные на именах переменных</h3>
<p>tbl = select(tbl, -(roll))</p>
</div>
<div id="-------" class="section level3">
<h3>Добавим новые столбцы, которые являются функциями существующих столбцов</h3>
</div>
<div id="--char-----" class="section level3">
<h3>Переменные типа char преобразуем их все в факторы</h3>
<p>tbl = tbl %&gt;% mutate_if(is.character, factor)</p>
</div>
<div id="----mutate_if--------factor----true-------is.character" class="section level3">
<h3>Здесь мы использовали функию mutate_if которая делает преобразование над колонкой - factor() при полученни значения TRUE от функции первого параметра - is.character()</h3>
</div>
<div id="---" class="section level3">
<h3>Заменяем ненужные нам символы</h3>
<p>names(tbl) = str_replace_all(names(tbl), “[!]”,“<em>emph</em>”)</p>
</div>
<div id="-----..-------------.--v--" class="section level3">
<h3>Нужно сделать такое последовательно много раз(т.к. нам нужно избавиться не только от !), что приведет к совершенно не читаемому результату. Поэтому воспользуеvся оператором пайппинга</h3>
<p>names(tbl) = names(tbl) %&gt;% str_replace_all(“[!]”,“<em>emph</em>”) %&gt;% str_replace_all(“[?]”,“<em>quest</em>”) %&gt;% str_replace_all(“[*]”,“<em>star</em>”) %&gt;% str_replace_all(“[+]”,“<em>plus</em>”) %&gt;% str_replace_all(“[-]”,“<em>minus</em>”) %&gt;% str_replace_all(“[@]”,“<em>at</em>”) %&gt;% str_replace_all(“[$]”,“<em>dollar</em>”) %&gt;% str_replace_all(“[#]”,“<em>hash</em>”) %&gt;% str_replace_all(“[/]”,“<em>div</em>”) %&gt;% str_replace_all(“[%]”,“<em>perc</em>”) %&gt;% str_replace_all(“[&amp;]”,“<em>amp</em>”) %&gt;% str_replace_all(“[\^]”,“<em>power</em>”) %&gt;% str_replace_all(“[()]”,“_“)</p>
<p>glimpse(tbl)</p>
</div>
<div id="----------------------" class="section level3">
<h3>Берем каждую колонку таблицы, передаем ее в функию в виде вектора и выдаем результат в виде вектора длинной равной количеству колонок в таблице</h3>
<p>sapply(tbl,is.numeric)</p>
</div>
<div id="--------------" class="section level3">
<h3>Подставляем этот вектор в саму таблицу и получаем таблицу состояющую только из интересующих нас колонок</h3>
<p>tbl_numeric = tbl[,sapply(tbl,is.numeric)]</p>
</div>
<div id="-----" class="section level3">
<h3>Получаем таблицу содержащую все остальные колонки</h3>
<p>tbl_non_numeric = tbl[,!sapply(tbl,is.numeric) ]</p>
</div>
</div>
<div id="-" class="section level2">
<h2>Корреляционный анализ</h2>
<p>cor_td = cor(tbl_numeric)</p>
<p>cor_td</p>
<div id="----------na" class="section level3">
<h3>Необходимо избаиться от все строк, где есть хоть одно значение NA</h3>
<p>cor_td = cor(drop_na(tbl_numeric))</p>
<p>cor_td</p>
</div>
<div id="---" class="section level3">
<h3>Преобразуем матрицу в таблицу</h3>
<p>cor_td = cor(drop_na(tbl_numeric)) %&gt;% as.data.frame %&gt;% select(co2_flux)</p>
<p>vars = row.names(cor_td)[cor_td$co2_flux^2 &gt; .1] %&gt;% na.exclude</p>
<p>vars</p>
<pre><code>[1] &quot;DOY&quot;                 &quot;co2_flux&quot;            &quot;h2o_molar_density&quot; 
[4] &quot;h2o_mole_fraction&quot;   &quot;h2o_mixing_ratio&quot;    &quot;air_pressure&quot;
[7] &quot;air_density&quot;         &quot;air_heat_capacity&quot;   &quot;air_molar_volume&quot;
[10] &quot;water_vapor_density&quot; &quot;e&quot;                   &quot;specific_humidity&quot; 
[13] &quot;Tdew&quot;                &quot;un_co2_flux&quot;         &quot;w.co2_cov&quot;
[16] &quot;h2o&quot;                 &quot;h2o.1&quot;               &quot;flowrate&quot;
attr(,&quot;na.action&quot;)
[1]  3  4  5  6 19 20 21 22 23 24 25 26 27
attr(,&quot;class&quot;)
[1] &quot;exclude&quot;</code></pre>
</div>
<div id="----------" class="section level3">
<h3>Соберем все переменные из вектора с именнами переменных в одну формулу</h3>
<p>formula1 = as.formula(paste(“co2_flux~” , paste(vars,collapse = “+”), sep=“”))</p>
</div>
</div>
<div id="--" class="section level2">
<h2>Создание линейной модели</h2>
<p>mod = lm(formula1, data=tbl_numeric)</p>
<div id="-----------mod" class="section level3">
<h3>Сравниваем различия между большой объединяющей группой и ее отдельными подгруппами по mod</h3>
<p>anova(mod)</p>
</div>
<div id="----summary-------mod-------r2------07." class="section level3">
<h3>Далее, с помощью функции summary(), получим общую информацию по нашей модели (mod), не забывая смотреть на коэффициент детерминации (R2), который не должен быть меньше 0,7.</h3>
<p>summary(mod)</p>
</div>
<div id="-----" class="section level3">
<h3>Создаем новую формулу уже со взаимодействиями</h3>
<p>formula2 = co2_flux ~ (DOY + co2_flux + h2o_molar_density + h2o_mole_fraction + h2o_mixing_ratio + water_vapor_density + e + specific_humidity + Tdew + un_co2_flux + w.co2_cov + h2o + h2o.1)^2</p>
</div>
<div id="-----" class="section level3">
<h3>Тоже самое делаем со второй моделью</h3>
<p>mod1 = lm(formula2, data=tbl_numeric)</p>
</div>
<div id="----------" class="section level3">
<h3>Смотрим, какие переменные и взаимодействия необходимо убрать для созданя идеальной модели</h3>
<p>anova(mod1)</p>
</div>
<div id="---" class="section level3">
<h3>Следим за коэффициентом детерминации</h3>
<p>summary(mod1)</p>
</div>
<div id="--.---.---" class="section level3">
<h3>Упрощаем нашу модель. Создаем новую формулу. Убираем ненужные переменные</h3>
<p>formula3 = co2_flux ~ (DOY + co2_flux + h2o_molar_density + h2o_mole_fraction + h2o_mixing_ratio + water_vapor_density + e + specific_humidity + Tdew + un_co2_flux + w.co2_cov + h2o + h2o.1)^2 - h2o_mole_fraction:Tdew - h2o_mole_fraction:un_co2_flux - h2o_mixing_ratio:un_co2_flux - water_vapor_density:h2o - Tdew:h2o - un_co2_flux:h2o - un_co2_flux:h2o.1 - w.co2_cov:h2o</p>
<p>mod2 = lm(formula3, data=tbl_numeric)</p>
</div>
<div id="------" class="section level3">
<h3>Смотрим, что необходимо убрать на этот раз</h3>
<p>anova(mod2)</p>
<p>summary(mod2)</p>
</div>
<div id="------" class="section level3">
<h3>Продолжаем упрощать нашу модель, удаляя ненужные переменные</h3>
<p>formula4 = co2_flux ~ (DOY + co2_flux + h2o_molar_density + h2o_mole_fraction + h2o_mixing_ratio + water_vapor_density + e + specific_humidity + Tdew + un_co2_flux + w.co2_cov + h2o + h2o.1)^2 - h2o_mole_fraction:Tdew - h2o_mole_fraction:un_co2_flux - h2o_mixing_ratio:un_co2_flux - water_vapor_density:h2o - Tdew:h2o - un_co2_flux:h2o - un_co2_flux:h2o.1 - w.co2_cov:h2o - w.co2_cov:h2o.1 - un_co2_flux:w.co2_cov - h2o_mole_fraction:h2o</p>
<p>mod3 = lm(formula4, data=tbl_numeric)</p>
</div>
<div id="-----" class="section level3">
<h3>Смотрим, что ненужынх переменных больше нет</h3>
<p>anova(mod3)</p>
</div>
<div id="--" class="section level3">
<h3>Коэффициент детерминации идеальный</h3>
<p>summary(mod3)</p>
<pre><code>Call:
lm(formula = formula4, data = tbl_numeric)
Residuals:
 Min         1Q     Median         3Q        Max
 -4.145e-05 -2.600e-06  9.300e-08  2.519e-06  5.617e-05
 Coefficients: (16 not defined because of singularities)
 Estimate Std. Error  t value Pr(&gt;|t|)
 (Intercept)                           -6.876e-01  1.792e-01   -3.837 0.000129***
 DOY                                    3.602e-04  1.392e-04    2.587 0.009761 **
 h2o_molar_density                      2.314e-03  3.475e-04    6.658 3.85e-11 ***
 h2o_mole_fraction                     -8.787e+01  3.798e+01   -2.314 0.020813 *
 h2o_mixing_ratio                      -3.490e+00  3.670e+00   -0.951 0.341836
 water_vapor_density                   -3.421e+02  3.484e+01   -9.818  &lt; 2e-16 ***
 e                                     -7.139e-04  2.580e-04   -2.768 0.005716 **
 specific_humidity                      1.470e+05  5.555e+04    2.647 0.008202 **
 Tdew                                   2.737e-03  7.215e-04    3.793 0.000154 ***
 w.co2_cov                             -1.150e+02  5.303e+00  -21.679  &lt; 2e-16 ***
 h2o                                   -8.790e-05  3.452e-05   -2.547 0.010978 *
 h2o.1                                 -9.421e-03  3.672e-02   -0.257 0.797529
 co2_flux:DOY                          -1.796e-06  1.562e-07  -11.493  &lt; 2e-16 ***
 DOY:h2o_molar_density                 -1.654e-07  9.714e-08   -1.702 0.088903 .
 DOY:h2o_mole_fraction                  6.236e-06  1.058e-04    0.059 0.953009 
 DOY:h2o_mixing_ratio                  -3.462e-05  1.088e-05   -3.182 0.001490 **
 DOY:water_vapor_density               -3.081e-04  3.331e-04   -0.925 0.355047 
 DOY:e                                  1.923e-08  5.114e-09    3.760 0.000176 ***
 DOY:specific_humidity                         NA         NA       NA       NA
 DOY:w.co2_cov                          8.261e-05  6.884e-05    1.200 0.230352
 DOY:h2o                                1.661e-07  9.590e-08    1.732 0.083407 .
 DOY:h2o.1                              2.927e-05  1.044e-04    0.280 0.779344
 co2_flux:h2o_molar_density             1.357e-06  1.924e-06    0.705 0.480868
 co2_flux:h2o_molar_density             1.357e-06  1.924e-06    0.705 0.480868
 co2_flux:water_vapor_density          -3.761e-01  6.178e-02   -6.087 1.45e-09 ***
 co2_flux:e                            -3.250e-05  1.781e-07 -182.436  &lt; 2e-16 ***
 co2_flux:specific_humidity             4.374e+03  2.677e+02   16.339  &lt; 2e-16 ***
 co2_flux:Tdew                          3.772e-03  7.300e-07 5166.705  &lt; 2e-16 ***
 co2_flux:un_co2_flux                   1.089e-05  9.685e-06    1.125 0.260830 
 co2_flux:w.co2_cov                    -4.193e-04  3.829e-04   -1.095 0.273608
 co2_flux:h2o                           2.651e-06  1.711e-06    1.550 0.121431
 h2o_molar_density:h2o_mole_fraction    1.402e-04  1.479e-04    0.948 0.343179
 h2o_molar_density:h2o_mixing_ratio    -1.456e-04  3.273e-05   -4.448 9.27e-06 ***
 h2o_molar_density:water_vapor_density -1.662e-03  1.020e-03   -1.629 0.103537
 h2o_molar_density:e                   -1.354e-07  1.813e-07   -0.747 0.455190
 h2o_molar_density:specific_humidity           NA         NA       NA       NA
 h2o_molar_density:Tdew                -8.364e-06  1.297e-06   -6.448 1.51e-10 ***
 h2o_molar_density:un_co2_flux          1.080e-05  4.296e-06    2.514 0.012035 *
 h2o_molar_density:w.co2_cov           -6.117e-04  1.672e-04   -3.659 0.000262 ***
 h2o_molar_density:h2o                 -9.117e-09  1.037e-08   -0.879 0.379436 
 h2o_molar_density:h2o.1                3.130e-05  1.487e-04    0.210 0.833360
 h2o_mole_fraction:h2o_mixing_ratio            NA         NA       NA       NA</code></pre>
</div>
<div id="----" class="section level3">
<h3>модель идеально описывает полученные данные</h3>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
